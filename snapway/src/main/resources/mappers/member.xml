<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.snapway.model.mapper.MemberMapper">

	<resultMap type="member" id="memberMap">
		<id column="id" property="id"/>
		<result column="email" property="email"/>
		<result column="password" property="password"/>
		<result column="username" property="username"/>
		<result column="role" property="role"/>
		<result column="created_at" property="createdAt"/>
		<result column="profile_img" property="profileImg"/>
		<result column="gender" property="gender"/>
		<result column="birthday" property="birthday"/>
		<result column="style_code" property="style"/>
	</resultMap>

	<insert id="registMember" parameterType="member" useGeneratedKeys="true" keyProperty="id" keyColumn="id">
		INSERT INTO member (
			email, password, username, role, gender, birthday, style_code, created_at
		) VALUES (
			#{email}, #{password}, #{username}, #{role}, #{gender}, #{birthday}, #{style}, now()
		)
	</insert>

	<select id="loginMember" parameterType="string" resultMap="memberMap">
		SELECT * FROM member WHERE email = #{email}
	</select>
    
    <select id="selectMemberById" parameterType="int" resultMap="memberMap">
        SELECT * FROM member WHERE id = #{id}
    </select>
    
    <select id="checkEmail" parameterType="string" resultType="int">
        SELECT count(*) FROM member WHERE email = #{email}
    </select>
    
    <update id="updateMember" parameterType="member">
        UPDATE member
        <set>
            <if test="password != null and password != ''"> password = #{password}, </if>
            <if test="username != null and username != ''"> username = #{username}, </if>
            <if test="profileImg != null and profileImg != ''"> profile_img = #{profileImg}, </if>
            <if test="gender != null"> gender = #{gender}, </if>
            <if test="birthday != null"> birthday = #{birthday}, </if>
            <if test="style != null"> style_code = #{style}, </if>
        </set>
        WHERE id = #{id}
    </update>

    <delete id="deleteMember" parameterType="string">
        DELETE FROM member WHERE email = #{email}
    </delete>

</mapper>